/*!
Wizard
Copyright 2018 CCRi.
*/
var stWizard;!function(a){a.StepDirection={Next:!0,Previous:!1,Closed:void 0};var b=function(){function b(b,c,d,e,f){var g=this;this.$rootScope=b,this.WidgetDef=c,this.wizardManager=d,this.Wizard=e,this.Step=f,this.createWizard=function(a,b,c,d,e,f){return e=_.isEmpty(e)?g.getNewScope():e,new g.Wizard(a,b,c,d,e,f)},this.createStep=function(b,c,d,e,f,h,i){if(c=g.getWidgetDef(c),d=g.getWidgetDef(d),_.isObject(h)){var j=h;h=function(b){var c=function(a){_.isFunction(a)&&a()};switch(c(j.beforeStepDirection),b){case a.StepDirection.Next:c(j.onNext);break;case a.StepDirection.Previous:c(j.onPrevious);break;default:c(j.onClose)}c(j.afterStepDirection)}}else _.isFunction(h)&&h();return new g.Step(b,c,d,e,f,h,i)},this.getNewScope=function(){return g.$rootScope.$new()},this.launchWizard=function(a){g.wizardManager.launchWizard(a)},this.closeWizard=function(){g.wizardManager.closeWizard()},this.lineQueryLayerFilter=function(a){return ccriUtils.strategies.filterDataSourcesByKeywords(["startDtg","endDtg"],a)},this.getDefaultLayerStepProps=function(){var a=function(a){return"time-lapse"!==a.type||a.isLineQuery()};return{dtgField:{label:"Time",labelFn:ccriUtils.strategies.propertyAccessor(),filterFn:ccriUtils.strategies.featurePropertiesFilter("date-time"),hideCondition:a},geomField:{label:"Geometry",labelFn:ccriUtils.strategies.propertyAccessor(),filterFn:ccriUtils.strategies.featurePropertiesFilter("Point"),hideCondition:a},idField:{label:"Color by",labelFn:ccriUtils.strategies.propertyAccessor(),filterFn:ccriUtils.strategies.featurePropertiesFilter(["boolean","string","int"])}}},this.getWidgetDef=function(a){if(!_.isEmpty(a))return _.isString(a)?new g.WidgetDef({tag:a}):new g.WidgetDef(a)}}return b.$inject=["$rootScope","ccri.angular-utils.WidgetDef","stealth.wizard.wizardManager","stealth.wizard.Wizard","stealth.wizard.Step"],b}();a.WizardHelper=b}(stWizard||(stWizard={}));var stWizard;!function(a){var b=function(){function a(a,b,c,d){var e=this;this.CONFIG=a,this.ol3Map=b,this.drawingInteractionService=c,this.wizardHelper=d,this.getDrawLineStep=function(a,b,c){return e.wizardHelper.createStep(a,{tag:"stealth-wizard-draw-line-step",scope:b,attrs:'geo-feature="geoFeature"'},null,!1,null,c)},this.getSetOptionsStep=function(a,b,c){return b.dot={finalCql:null,cqlMaxlength:_.get(e.CONFIG,"geoserver.cqlMaxLength",1/0),showBinSortOption:!_.get(e.CONFIG,"timelapse.hideBinSortOption"),appContext:_.get(e.CONFIG,"app.context")},e.wizardHelper.createStep("Set options",{tag:"stealth-wizard-query-options-step",scope:b},null,!0,null,c)},this.getSelectLayerStep=function(a,b,c){return b.layerProperties=_.isEmpty(b.selectLayerStepProps)?e.wizardHelper.getDefaultLayerStepProps():b.selectLayerStepProps,e.wizardHelper.createStep(a,{tag:"stealth-wizard-select-layer-step",scope:b,attrs:'query="query" layer-properties="layerProperties"'},null,!0,null,c)}}return a.prototype.teardownPreviousSteps=function(a,b){b=b||a.length-1;var c=_.slice(a,0,b);_.each(c,function(a){a.getTeardown()()})},a.$inject=["CONFIG","ol3Map","stealth.core.drawingInteractionService","stealth.wizard.wizardHelper"],a}();a.CommonWizardSteps=b}(stWizard||(stWizard={})),angular.module("stealth.wizard",["stealth.wizard.templates"]).namespace(),angular.module("stealth.wizard").service("wizardHelper",stWizard.WizardHelper).service("commonWizardSteps",stWizard.CommonWizardSteps).directive("selectLayerStep",[function(){return{restrict:"E",templateUrl:"stealth.wizard/templates/selectLayerStep.tpl.html",scope:"="}}]).directive("layerProps",[function(){return{restrict:"E",scope:"=",templateUrl:"stealth.wizard/templates/layerProps.tpl.html"}}]).directive("drawLineStep",[function(){return{restrict:"E",templateUrl:"stealth.wizard/templates/drawLineStep.tpl.html",scope:!1,controller:["$scope","$rootScope","ol3Map","stealth.core.drawingInteractionService",function(a,b,c,d){function e(a){b.$emit("stealth.wizard.drawstart",a),l&&(l.un("change",g),l=null),k.geoFeature=a.feature,l=k.geoFeature.getGeometry(),l.on("change",g)}function f(a){b.$emit("stealth.wizard.drawend",a)}function g(a){var c={originalEvent:a,geometry:a.target,feature:k.geoFeature,drawing:k.drawing};b.$emit("stealth.wizard.drawing.geometryChange",c)}function h(){m(),m=null,n&&(n.un("drawstart",e),n.un("drawend",f),n=null),l&&(l.un("change",g),l=null),k&&(_.isEmpty(k.drawing)&&_.isEmpty(k.geoFeature)||k.destroy()),i=j=k=null}var i,j,k,l,m=a.$on("$destroy",h);a.drawingModel.drawingInteraction?k=a.drawingModel.drawingInteraction:(i=d.createOverlay(),j=d.createDrawing(i,"LineString"),k=d.createDrawingInteraction(i,j,c,a.$new()),a.drawingModel.drawingInteraction=k,a.drawingModel.geoFeature=k.geoFeature,k.init(),_.has(a.drawingModel,"exsistingFeature")&&(a.drawingModel.drawingInteraction.geoFeature=a.drawingModel.exsistingFeature,a.drawingModel.geoFeature=a.drawingModel.drawingInteraction.geoFeature,a.drawingModel.drawingInteraction.setActive(!1),a.drawingModel.drawingInteraction.drawing.setActive(!1),a.drawingModel.drawingInteraction.overlay.addFeature(a.drawingModel.drawingInteraction.geoFeature),Geo.labelFeaturePoints(a.drawingModel.drawingInteraction.geoFeature,a.routes[0].getDirection(),a.routeStyleOps),a.drawingModel.drawingInteraction.redraw()));var n=k.drawing;n.on("drawstart",e),n.on("drawend",f)}]}}]).directive("drawStepTools",["stealth.core.drawingInteractionService",function(a){return{restrict:"E",templateUrl:"stealth.wizard/templates/drawStepTools.tpl.html",scope:!1,controller:["$scope","$rootScope",function(b,c){var d=c.$on("stealth.wizard.drawend",function(a,c){b.drawingModel.geoFeature=c.feature}),e=b.$on("$destroy",function(){d(),e(),e=d=null});b.eraseAll=function(){b.drawingModel.drawingInteraction.drawing.getActive()||(void 0!==b.drawingModel.geoFeature&&(b.drawingModel.geoFeature=null),_.isEmpty(b.drawingModel.drawingInteraction)||(b.drawingModel.drawingInteraction.erase(),b.drawingModel.drawingInteraction.init()),c.$emit("stealth.wizard.drawtools.eraseAll"))},b.upload=function(){var b=angular.element('input[name="drawingUpload"')[0];a.uploadDrawings(b),b=null},b.save=function(c){a.saveDrawings(c,b.drawingModel.drawingInteraction.overlay,b.fileName||"geofeatures")}}]}}]).directive("queryOptionsStep",["ccri.angular-utils.WidgetDef",function(a){return{restrict:"E",templateUrl:"stealth.wizard/templates/queryOptionsStep.tpl.html",scope:{labelPosition:"@",query:"=",dot:"="},transclude:!0,link:function(b){if(_.has(b.query.layerData.currentLayer.KeywordConfig,"query.customWizardOptions")){var c=_.get(b.query.layerData.currentLayer.KeywordConfig,["query","customWizardOptions"]);b.customOptionsWidget=new a({tag:c,scope:b,attrs:'query="query"'})}}}}]).directive("cqlOptions",[function(){return{restrict:"E",templateUrl:"stealth.wizard/templates/cqlOptions.tpl.html",scope:{query:"=",dot:"=",labelPosition:"@"}}}]).directive("directionSelect",function(){return{restrict:"E",templateUrl:"stealth.wizard/templates/directionSelect.tpl.html",scope:{label:"@",getDirections:"=",setDirection:"=",currentDirection:"="}}});var stWizard;!function(a){function b(a,b,h,i){return d=a,e=b,f=h,g=i,c}var c=function(){function a(){}return a.run=function(a,b){function c(a,b){return _.map(a,function(a){var c=e.$new();c.selections=b,j.push(c);var d=a(b,c),f=d.getCustomValidationFn();return d.setCustomValidationFn(function(){return!(f&&!f())&&(!c.wizardForm||!c.wizardForm.$invalid)}),d})}function d(){_.forEach(j,function(a){a.$destroy()}),j.length=0,j=null}var h=a.steps,i=_.defaults({},a.displaySettings,{wizardTitle:"",wizardClass:"",mainIconClass:"",finishIconClass:"fa-check text-success"});b=b||{};var j=[],k=c(h,b),l=new g(i.wizardTitle,i.mainIconClass,i.finishIconClass,k,null,i.wizardClass);i.endActionText&&l.setEndActionText(i.endActionText);var m=f.launchWizard(l).then(function(){return b}).finally(d);return a=h=i=k=l=null,m},a}();a.WizardRunner=c;var d,e,f,g;b.$inject=["$q","$rootScope","stealth.wizard.wizardManager","stealth.wizard.Wizard"],a.wizardRunnerFactory=b}(stWizard||(stWizard={})),angular.module("stealth.wizard",[]).factory("WizardRunner",stWizard.wizardRunnerFactory);var stWizard;!function(a){var b=function(){function a(a,b,c,d,e,f,g){this.title=a,this.formDef=b,this.toolDef=c,this.mask=d,this.setup=e,this.teardown=f,this.addsStep=g,this.cssClass="",this.mask=!!this.mask,this.setup=this.setup||_.noop,this.teardown=this.teardown||_.noop,this.addsStep=!!this.addsStep}return a.prototype.getTitle=function(){return this.title},a.prototype.getFormDef=function(){return this.formDef},a.prototype.getToolDef=function(){return this.toolDef},a.prototype.getMask=function(){return this.mask},a.prototype.getSetup=function(){return this.setup},a.prototype.getTeardown=function(){return this.teardown},a.prototype.getAddsStep=function(){return this.addsStep},a.prototype.getCustomValidationFn=function(){return this.customValidationFn},a.prototype.setCustomValidationFn=function(a){this.customValidationFn=a},a.prototype.getCssClass=function(){return this.cssClass},a.prototype.setCssClass=function(a){this.cssClass=a},a}();a.Step=b}(stWizard||(stWizard={})),angular.module("stealth.wizard",[]).factory("Step",[function(){return stWizard.Step}]);var stWizard;!function(a){var b=function(){function a(a,b,c,d,e,f,g){this.title=a,this.iconClass=b,this.endIconClass=c,this.steps=d,this.wizardScope=e,this.customClass=f,this.closeHandler=g,this.endActionText="Done",this.steps=this.steps||[]}return a.prototype.getTitle=function(){return this.title},a.prototype.getIconClass=function(){return this.iconClass},a.prototype.getEndIconClass=function(){return this.endIconClass},a.prototype.setEndIconClass=function(a){this.endIconClass=a},a.prototype.getEndActionText=function(){return this.endActionText},a.prototype.setEndActionText=function(a){this.endActionText=a},a.prototype.getSteps=function(){return this.steps},a.prototype.getWizardScope=function(){return this.wizardScope},a.prototype.getCustomClass=function(){return this.customClass},a.prototype.callCloseHandler=function(a){return _.isFunction(this.closeHandler)?this.closeHandler.call(null,a):void 0},a.prototype.truncateSteps=function(a){var b=a+1;this.steps.splice(b,this.steps.length-b)},a.prototype.appendWizard=function(a){var b=a.getEndIconClass();b&&(this.endIconClass=b),this.steps=this.steps.concat(a.getSteps())},a}();a.Wizard=b}(stWizard||(stWizard={})),angular.module("stealth.wizard",[]).factory("Wizard",[function(){return stWizard.Wizard}]);var stWizard;!function(a){var b=function(){function a(a){var b=this;this.$rootScope=a,this.registerLaunchListener=function(a){return b.$rootScope.$on("wizard:launchWizard",a)},this.registerCloseListener=function(a){return b.$rootScope.$on("wizard:closeWizard",a)}}return a.$inject=["$rootScope"],a}();a.WizardDispatcher=b}(stWizard||(stWizard={})),angular.module("stealth.wizard",[]).service("wizardDispatcher",stWizard.WizardDispatcher);var stWizard;!function(a){var b=function(){function a(a,b){this.$q=a,this.$rootScope=b,this._wizard=null,this._wizardDeferred=null,this._visible=!1,this._currentStepNum=null,this._mask=!0,this._processing=!1,this._footerVisible=!0,this.collapsed=!1}return a.prototype._updateCurrentStep=function(a,b){var c=this;void 0===b&&(b=!1);var d=this._wizard;if(d&&!_.isEmpty(d.getSteps())){var e=void 0;this._processing=!0,e=_.isNumber(this._currentStepNum)&&!b?this.$q.when(d.getSteps()[this._currentStepNum].getTeardown().call(d,a>this._currentStepNum,this._currentStepNum)):this.$q.when(),e.then(function(){var b=d.getSteps()[a];b&&(b.getSetup().call(d,a),c._mask=b.getMask(),c._currentStepNum=a)}),e.finally(function(){c._processing=!1})}},a.prototype.getVisible=function(){return this._visible},a.prototype.getCurrentStepNum=function(){return this._currentStepNum},a.prototype.getCurrentStep=function(){if(this._wizard){var a=this._wizard.getSteps();if(!_.isEmpty(a))return a[this._currentStepNum]}return null},a.prototype.isCurrentStepProcessing=function(){return this._processing},a.prototype.getMask=function(){return this._mask},a.prototype.getFooterVisible=function(){return this._footerVisible},a.prototype.showFooter=function(){this._footerVisible=!0},a.prototype.hideFooter=function(){this._footerVisible=!1},a.prototype.getIconClass=function(){return this._wizard?this._wizard.getIconClass():null},a.prototype.getSteps=function(){return this._wizard?this._wizard.getSteps():[]},a.prototype.getEndIconClass=function(){return this._wizard?this._wizard.getEndIconClass():null},a.prototype.getEndActionText=function(){return this._wizard?this._wizard.getEndActionText():null},a.prototype.getCustomClass=function(){return this._wizard?this._wizard.getCustomClass():null},a.prototype.isLastStep=function(){return this._wizard&&this._currentStepNum===this._wizard.getSteps().length-1&&!this.getCurrentStep().getAddsStep()},a.prototype.isCurrentStepInvalid=function(){var a=this.getCurrentStep();if(a){var b=a.getCustomValidationFn();if(_.isFunction(b)){var c=b();if(!c)return!0}else{var d=a.getFormDef();if(d){var e=d.scope;if(e)return e.wizardForm&&e.wizardForm.$invalid}}}return!1},a.prototype.launchWizard=function(a){var b=this;return this.closeWizard().then(function(){return b._wizard=a,b._updateCurrentStep(0),b._visible=!0,b.collapsed=!1,b.$rootScope.$emit("wizard:launchWizard",b._wizard),b._wizardDeferred=b.$q.defer(),b._wizardDeferred.promise})},a.prototype.closeWizard=function(a){var b,c=this,d=this.$q.when(),e=this._wizard,f=this._wizardDeferred;return this._processing?this.$q.reject():(e&&(this._processing=!0,_.isNumber(this._currentStepNum)&&(b=this.$q.when(e.getSteps()[this._currentStepNum].getTeardown().call(this._wizard,a,this._currentStepNum)),d=b.then(function(){if(a&&!c.isLastStep())return c._updateCurrentStep(c._currentStepNum+1,!0),c.$q.reject()})),d.then(function(){e.getWizardScope()&&e.getWizardScope().$destroy(),e.callCloseHandler(!!a),a?f.resolve():f.reject(),c._wizardDeferred=f=null,c._visible=!1,c._currentStepNum=null,c._mask=!1,c._wizard=e=null,c._footerVisible=!0,c.$rootScope.$emit("wizard:closeWizard")}),d.finally(function(){c._processing=!1})),d)},a.prototype.jumpToPastStep=function(a){this._processing||a<this._currentStepNum&&this._updateCurrentStep(a)},a.prototype.previousStep=function(){this._processing||this._currentStepNum>0&&this._updateCurrentStep(this._currentStepNum-1)},a.prototype.nextStep=function(){this._wizard&&!_.isEmpty(this._wizard.getSteps())&&(this._currentStepNum<this._wizard.getSteps().length-1?this._updateCurrentStep(this._currentStepNum+1):this.closeWizard(!0))},a}();a.WizardManager=b}(stWizard||(stWizard={})),angular.module("stealth.wizard").service("wizardManager",["$q","$rootScope",function(a,b){return new stWizard.WizardManager(a,b)}]),angular.module("stealth.wizard",[]).directive("view",["$injector","stealth.wizard.wizardManager",function(a,b){return{restrict:"E",scope:{},templateUrl:"stealth.wizard/core/stWizardView.tpl.html",link:{pre:function(c,d){c.manager=b,c.$watch(function(){return b.getCurrentStep()},function(){c.$broadcast("form-reset")});try{var e=a.get("$animate");e.enabled(d.find(".wizardForm"),!1)}catch(a){}}}}}]),angular.module("stealth.wizard.templates",[]).run(["$templateCache",function(a){a.put("stealth.wizard/core/stWizardView.tpl.html",'<div style="text-align:center;" class="fullHeight" ng-class="{\'ng-hide\': !manager.getVisible()}">\n    <div class="anchorAll wizardMask" ng-if="manager.getMask()"></div>\n    <div class="wizardSteps anchorLeft anchorTop">\n        <span class="step-zero" ng-click="manager.closeWizard()">\n            <div class="btn" style="position:relative;top:-1px;">\n                <i class="fa fa-fw fa-lg fa-close text-danger"></i>\n            </div>\n        </span>\n        <span ng-repeat="step in manager.getSteps()"\n              ng-class="{active: $index==manager.getCurrentStepNum(),\n                        pastWizardStep: $index<manager.getCurrentStepNum()}"\n              ng-click="manager.jumpToPastStep($index)"\n              ng-if="manager.getVisible()">\n            {{::step.getTitle()}}\n        </span>\n        <span ng-if="manager.getEndIconClass()">\n            <i class="fa fa-fw fa-lg" ng-class="manager.getEndIconClass()"></i>\n        </span>\n    </div>\n    <div class="wizardForm {{manager.getCustomClass()}} {{manager.getCurrentStep().getCssClass()}}" ng-class="{\'collapsed\': manager.collapsed}"\n         ccri-angular-utils-form-error-manager>\n        <div class="wizardFormHeader">\n            <span>\n                <i class="fa fa-fw fa-lg" ng-class="manager.getIconClass()"></i>\n            </span>\n            {{manager.getCurrentStep().getTitle()}}\n            <span class="clickable"\n                ng-click="manager.collapsed = !manager.collapsed">\n                <i class="pull-right fa fa-fw" style="position: relative; top: 2px;"\n                    ng-class="manager.collapsed ? \'fa-chevron-right\' : \'fa-chevron-down\'" ></i>\n            </span>\n            <!-- step\'s tools added via widget compiler -->\n            <ccri-angular-utils-widget-compiler widget-def="manager.getCurrentStep().getToolDef()" widget-watch\n                                class="pull-right"\n                                ng-if="manager.getCurrentStep() && manager.getCurrentStep().getToolDef()">\n            </ccri-angular-utils-widget-compiler>\n        </div>\n        <div class="wizardFormContent" ng-class="{\'collapsed-v\': manager.collapsed}">\n            <!-- step\'s form content added via widget compiler -->\n            <ccri-angular-utils-widget-compiler widget-def="manager.getCurrentStep().getFormDef()" widget-watch\n                                ng-if="manager.getCurrentStep() && manager.getCurrentStep().getFormDef()">\n            </ccri-angular-utils-widget-compiler>\n        </div>\n        <div class="wizardFormFooter"\n             ng-class="{\'ng-hide\': !manager.getFooterVisible(), \'collapsed-v\': manager.collapsed}">\n            <div class="pull-right" style="margin-left:4px;"\n                 ccri-angular-utils-show-form-errors="hover"\n                 ng-switch on="manager.isLastStep()">\n                <span class="btn btn-xs btn-default"\n                      ng-switch-default\n                      ng-disabled="manager.isCurrentStepInvalid() || manager.isCurrentStepProcessing()"\n                      ng-click="manager.isCurrentStepInvalid() || manager.isCurrentStepProcessing() || manager.nextStep()">\n                    Next\n                    <i class="fa fa-caret-right" ng-if="!manager.isCurrentStepProcessing()"></i>\n                    <i class="fa fa-circle-o-notch fa-spin" ng-if="manager.isCurrentStepProcessing()"></i>\n                </span>\n                <span class="btn btn-xs btn-default"\n                      ng-switch-when="true"\n                      ng-disabled="manager.isCurrentStepInvalid() || manager.isCurrentStepProcessing()"\n                      ng-click="manager.isCurrentStepInvalid() || manager.isCurrentStepProcessing() || manager.closeWizard(true)">\n                    <b>{{manager.getEndActionText()}}</b>\n                    <span ng-if="manager.isCurrentStepProcessing()">\n                        <i class="fa fa-circle-o-notch fa-spin"></i>\n                    </span>\n                    <span ng-if="manager.getEndIconClass() && !manager.isCurrentStepProcessing()">\n                        <i class="fa" ng-class="manager.getEndIconClass()"></i>\n                    </span>\n                </span>\n            </div>\n            <div class="pull-right" ng-switch on="manager.getCurrentStepNum() === 0">\n                <span class="btn btn-xs btn-default"\n                      ng-disabled="manager.isCurrentStepProcessing()"\n                      ng-switch-default\n                      ng-click="manager.previousStep()">\n                    <i class="fa fa-caret-left"></i>\n                    Previous\n                </span>\n                <span class="btn btn-xs btn-default"\n                      ng-disabled="manager.isCurrentStepProcessing()"\n                      ng-switch-when="true"\n                      ng-click="manager.closeWizard()">\n                    <i class="fa fa-close text-danger"></i>\n                    Cancel\n                </span>\n            </div>\n            <div class="clearfix"></div>\n        </div>\n    </div>\n</div>\n'),a.put("stealth.wizard/templates/cqlOptions.tpl.html",'<ng-form name="wizardForm" class="CqlOptionsForm">\n    <ccri-angular-utils-formfield type="text" label-position="{{labelPosition}}" label="Query Name" name="storeName" value="query.params.storeName"\n                                                 on-change="nameEdited=true" error-condition="wizardForm.nonDefaultName.$invalid"></ccri-angular-utils-formfield>\n    <ccri-angular-utils-formfield type="text" label-position="{{labelPosition}}" label="CQL Filter" name="cql" value="query.params.cql"></ccri-angular-utils-formfield>\n    <div ng-switch="query.featureTypeData"\n         style="color:black;background:#2c2c2c;border-radius:4px;padding:0;">\n        <div ng-switch-when="unavailable" class="alert alert-warning">\n            <i class="fa fa-warning"></i> There is no feature type description for this layer.\n        </div>\n        <div ng-switch-default>\n            <ccri-angular-utils-accordion-list title-class="callToAction" label-align="accordion-label-align-right" list="query.featureTypeData.featureTypes" header-key="Properties for {{query.layerData.currentLayer.Title}}">\n                <table class="table-condensed">\n                    <tr ng-repeat="property in object.properties">\n                        <td>{{property.name}}</td>\n                        <td><code>{{property.localType}}</code></td>\n                    </tr>\n                </table>\n            </ccri-angular-utils-accordion-list>\n        </div>\n    </div>\n    <div ng-if="query.isSaveable">\n        <div class="vertically-buffered">\n            <div class="labeled-wide-field buf-sm-mb">\n                <span class="field-descriptor">&nbsp;</span>\n                <span class="field-input clickable" ng-click="query.shouldBeSaved = !query.shouldBeSaved">\n                    <i class="fa fa-fw" ng-class="query.shouldBeSaved ? \'fa-check-square-o\' : \'fa-square-o\'"></i>\n                    Save as filter for future use?\n                </span>\n            </div>\n\n            <!-- If the user is saving a new query, make them change the name from the default pre-populated name.\n                 This is a hidden field validator, to disable the wizard next button (via form invalidity).\n                 It\'s always empty, and when it becomes required, it triggers the validation. -->\n            <input name="nonDefaultName" type="hidden" ng-model="_empty_"\n                   ng-required="query.shouldBeSaved && !query.editMode && !nameEdited">\n\n            <div class="labeled-wide-field">\n                <span class="field-descriptor">&nbsp;</span>\n                <span class="field-input clickable" ng-click="query.shouldBeShared = query.shouldBeSaved ? !query.shouldBeShared : query.shouldBeShared"\n                      ng-disabled="!query.shouldBeSaved">\n                    <i class="fa fa-fw" ng-class="query.shouldBeShared ? \'fa-check-square-o\' : \'fa-square-o\'"></i>\n                    Share this filter with others?\n                </span>\n            </div>\n        </div>\n\n        <div class="flex-row labeled-wide-field">\n            <span class="field-descriptor text-right" ng-disabled="!query.shouldBeSaved">Classification:</span>\n            <span class="field-input">\n                <ccri-angular-utils-select ng-model="query.classification"\n                                           select-disabled="!query.shouldBeSaved"\n                                           from-list="query.classifications"\n                                           label-fn="labelFn"\n                                           placeholder="Select a classification"\n                                           empty-message="None available"\n                ></ccri-angular-utils-select>\n            </span>\n        </div>\n    </div>\n    <st-live-wiz-cql-length name="cqlTotalLength" ng-model="cqlTotalLength" ng-model-options="{getterSetter:true}"\n                            cql-maxlength="{{dot.cqlMaxlength}}"\n    ></st-live-wiz-cql-length>\n</ng-form>\n'),a.put("stealth.wizard/templates/directionSelect.tpl.html",'<div class="DirectionSelect">\n    <label class="pull-left">{{label ? label : "Direction"}}</label>\n    <span class="horizontally-buffered">\n        <span ng-repeat="(key, direction) in getDirections()" class="DirectionButton"\n              ng-class="{\'selected\': currentDirection.name === direction.name}"\n              ng-click="setDirection(direction)"\n              uib-tooltip="{{direction.name}}" tooltip-class="nowrap"\n              tooltip-placement="bottom-right" tooltip-animation="true" tooltip-popup-delay="600"\n              tooltip-trigger="mouseenter">\n              <i class="{{direction.iconClass}}"></i>\n        </span>\n    </span>\n</div>\n'),a.put("stealth.wizard/templates/drawLineStep.tpl.html",'<ng-form name="wizardForm">\n    <input type="hidden" ng-model="drawingModel.drawingInteraction.geoFeature" required/>\n    <span class="pull-right"><stealth-wizard-draw-step-tools></stealth-wizard-draw-step-tools></span>\n    <div style="margin: 5px 0px 0px 10px">Click to draw line segments.</div>\n    <div style="margin-left: 10px">Double-click to finish drawing.</div>\n</ng-form>\n'),a.put("stealth.wizard/templates/drawStepTools.tpl.html",'<div class="btn-group text-right">\n    <a class="btn" ng-click="eraseAll()" ng-disabled="drawingModel.geoFeature | lodash:\'isEmpty\'"\n       uib-tooltip="Erase all" tooltip-class="nowrap"\n       tooltip-placement="top" tooltip-animation="false" tooltip-popup-delay="500"\n       tooltip-trigger="mouseenter" tooltip-append-to-body="true">\n        <i class="fa fa-fw fa-eraser"></i>\n    </a>\n    <span uib-dropdown dropdown-append-to-body="true">\n        <a uib-dropdown-toggle class="btn dropdown-toggle" ng-disabled="drawingModel.geoFeature | lodash:\'isEmpty\'"\n           uib-tooltip="Save to file" tooltip-class="nowrap"\n           tooltip-placement="top" tooltip-animation="false" tooltip-popup-delay="500"\n           tooltip-trigger="mouseenter" tooltip-append-to-body="true" ng-disabled="geoFeature | lodash:\'isEmpty\'">\n            <i class="fa fa-fw fa-save"></i>\n            <span class="caret"></span>\n        </a>\n        <ul uib-dropdown-menu class="dropdown-menu" role="menu">\n            <li ng-click="save(\'json\')"><a href="">GeoJSON</a></li>\n        </ul>\n    </span>\n    <a class="btn" ng-click="upload()" ng-disabled="geoFeature"\n       uib-tooltip="Load from file" tooltip-class="nowrap"\n       tooltip-placement="top" tooltip-animation="false" tooltip-popup-delay="500"\n       tooltip-trigger="mouseenter" tooltip-append-to-body="true">\n        <i class="fa fa-fw fa-folder-open"></i>\n    </a>\n    <input type="file" class="hidden" name="drawingUpload">\n</div>\n'),a.put("stealth.wizard/templates/layerProps.tpl.html",'<div class="flex-row flex-align-items-center buf-xs-mt" ng-repeat="(key, value) in layerProperties"\n     ng-hide="!query.layerData.currentLayer">\n    <div ng-hide="value.hideCondition(query)" class="full-width text-right">\n        <label class="text-right">{{value.label}}</label>\n        <span class="field-input pull-right">\n            <ccri-angular-utils-select ng-model="query.params[key]"\n                                       from-list="(value.fromList ? value.fromList : query.featureTypeData.featureTypes[0].properties)"\n                                       label-fn="value.labelFn"\n                                       filter-fn="value.filterFn"\n                                       placeholder="Select {{value.label}} field"\n                                       empty-message="{{(value.emptyMessage ? value.emptyMessage : \'None available\')}}"\n            ></ccri-angular-utils-select>\n        </span>\n        <span class="field-unit">&nbsp;</span>\n    </div>\n</div>\n'),a.put("stealth.wizard/templates/queryOptionsStep.tpl.html",'<st-wiz-section>\n    <ng-form name="wizardForm">\n        <div ng-transclude></div>\n        <stealth-wizard-cql-options query="query" dot="dot" label-position="{{labelPosition}}"></stealth-wizard-cql-options>\n    </ng-form>\n</st-wiz-section>\n'),a.put("stealth.wizard/templates/selectLayerStep.tpl.html",'<ng-form name="wizardForm">\n        <st-wiz-section>\n            <div class="buf-lg-pt">\n                <st-wiz-data-source query="query" filter-fn="dataSourceFilterFn"></st-wiz-data-source>\n            </div>\n            <div class="buf-lg-pb">\n                <stealth-wizard-layer-props query="query" properties="layerProperties"></stealth-wizard-layer-props>\n            </div>\n        </st-wiz-section>\n        <st-wiz-section>\n            <div class="buf-lg-pt">\n                <st-wiz-timerange></st-wiz-timerange>\n            </div>\n        </st-wiz-section>\n</ng-form>\n')}]);